# 文件恢复方案

## 损失情况
- 总下载: 4045 个文件
- 现存: 2080 个文件  
- **丢失: 约 2000 个文件**

主要原因：kb_watcher 每 60 秒删除 Unknown 目录（已修复）

---

## 双轨恢复策略

### 🚀 轨道1: 快速恢复下载器（新建）

**启动方式：**
```bash
.\start_recovery.bat
```

**特点：**
- 36 个精准搜索查询（基于丢失文件分析）
- 高优先级：TI、ADI、MPS 等主要厂商
- 每个查询下载 10 个文件
- 预计恢复 300-500 个文件（第一轮）

**运行建议：**
- 可多次运行（搜索结果会有差异）
- 按 Ctrl+C 可随时停止
- 与 continuous_searcher 同时运行不冲突

---

### 🔄 轨道2: 持续下载器（已有）

**启动方式：**
```bash
.\start_continuous.bat
```

**特点：**
- 广泛覆盖所有类型的 DC-DC 文件
- 自动去重、厂商识别
- 长期运行，自然恢复

**当前状态：**
- 已下载 4267 个记录
- 继续运行会重新下载相同关键词的文件

---

## 配套系统（自动处理）

### 1. 分类器（16 线程并行）
```bash
.\start_classify_watch.bat
```
- 自动分类下载的文件
- **已修复线程安全问题**

### 2. 知识库入库
```bash
.\start_kb_watch.bat  
```
- 自动入库已分类文件
- **已停止删除 Unknown 目录**
- 只删除 Trash（完全无效文件）

---

## 使用方案

### 方案A: 快速恢复（推荐）
1. 打开 3 个终端窗口
2. 运行 `start_recovery.bat`（快速恢复）
3. 运行 `start_continuous.bat`（持续下载）
4. 运行 `start_classify_watch.bat`（自动分类）

**预期效果：**
- 1-2 天恢复 500+ 个文件
- 1-2 周恢复 1500+ 个文件

### 方案B: 自然恢复（省心）
1. 只运行 `start_continuous.bat`
2. 运行 `start_classify_watch.bat`
3. 让系统自动运行

**预期效果：**
- 2-4 周自然恢复大部分文件

---

## 保护措施（已实施）

✅ **停止删除 Unknown 目录**  
✅ **只删除 Trash（完全无效文件）**  
✅ **修复分类器线程安全问题**  
✅ **修复多线程并行实现**  

---

## 监控恢复进度

```bash
# 统计当前文件数
python full_file_audit.py

# 查看知识库状态
python check_kb_history.py
```

---

## 注意事项

1. **不要同时运行多个 recovery_downloader**（会重复下载）
2. **可以多次运行 start_recovery.bat**（每次搜索结果略有不同）
3. **分类器和知识库 watcher 应该持续运行**
4. **丢失的 2000 个文件无法直接恢复，只能重新下载相似内容**

---

## 预期时间线

- **1 天**: 恢复 200-300 个文件
- **3 天**: 恢复 500-700 个文件  
- **1 周**: 恢复 1000-1200 个文件
- **2 周**: 恢复 1500-1800 个文件

由于搜索引擎结果的限制，可能无法 100% 恢复所有文件，但可以恢复约 80-90% 的主要内容。
